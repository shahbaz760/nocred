name: nocred

on:
    push:
        branches:
              - main
              
permissions:
  id-token: write
  contents: read


jobs:
    build:
      runs-on: ubuntu-latest
      
      steps:
          - name: Checkout code
            uses: actions/checkout@v2
            
          - name: Set up AWS credentials via OIDC
            id: aws-oidc
            uses: aws-actions/configure-aws-credentials@v1
            with:
              role-to-assume: arn:aws:iam::637527414831:role/github-actions # Replace with your IAM Role ARN
              aws-region: us-east-1 

          - name: Get env from aws secret manager
            run: aws secretsmanager get-secret-value --secret-id arn:aws:secretsmanager:us-east-2:637527414831:secret:env-7cExoX | jq -r '.SecretString | fromjson | .env'

    
